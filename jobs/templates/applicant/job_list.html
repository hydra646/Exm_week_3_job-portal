{% extends 'base.html' %}

{% block title %}Available Jobs{% endblock %}

{% block content %}
    <h2>Available Jobs</h2>

    <form method="GET" action="{% url 'job_list' %}" class="search-form">
        <input type="text" name="q" placeholder="Search all fields (title, desc, company, loc)..." value="{{ query|default_if_none:'' }}">
        <input type="text" name="title" placeholder="Search by title..." value="{{ title_query|default_if_none:'' }}">
        <input type="text" name="company" placeholder="Search by company..." value="{{ company_query|default_if_none:'' }}">
        <input type="text" name="location" placeholder="Search by location..." value="{{ location_query|default_if_none:'' }}">
        <button type="submit" class="btn">Search</button>
        <a href="{% url 'job_list' %}" class="btn" style="background-color: #6c757d;">Clear Filters</a>
    </form>

    {% if jobs %}
        <ul>
            {% for job in jobs %}
                <div class="job-card">
                    <h3><a href="{% url 'job_detail' job.id %}">{{ job.title }}</a></h3>
                    <p><strong>Company:</strong> {{ job.company_name }}</p>
                    <p><strong>Location:</strong> {{ job.location }}</p>
                    <p>{{ job.description|truncatechars:150 }}</p>
                    <p>Posted by: {{ job.posted_by.username }} on {{ job.created_at|date:"M d, Y" }}</p>
                    <p><a href="{% url 'job_detail' job.id %}" class="btn">View Details</a></p>
                </div>
            {% endfor %}
        </ul>
    {% else %}
        <p>No jobs available matching your criteria.</p>
        {% if query or title_query or company_query or location_query %}
            <p>Try clearing your search filters.</p>
        {% endif %}
    {% endif %}
{% endblock %}

